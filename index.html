<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ocean City Surf Forecast</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background: #eef5f9;
        color: #333;
        margin: 0;
        padding: 0;
      }
      header {
        background-color: #0077b6;
        color: white;
        padding: 1rem;
        text-align: center;
      }
      .summary-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
        padding: 1rem;
      }
      .day-card {
        background: white;
        border-radius: 10px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        padding: 1rem;
        cursor: pointer;
      }
      .rating {
        font-weight: bold;
        color: #0077b6;
      }
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
      }
      .modal-content {
        background: white;
        padding: 2rem;
        border-radius: 10px;
        max-width: 600px;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>Ocean City Surf Forecast</h1>
    </header>
    <div class="summary-grid" id="forecastGrid"></div>

    <div class="modal" id="detailModal">
      <div class="modal-content" id="modalContent"></div>
    </div>

    <script>
      const forecastGrid = document.getElementById("forecastGrid");
      const modal = document.getElementById("detailModal");
      const modalContent = document.getElementById("modalContent");

      async function loadForecast() {
        try {
          const surfRes = await fetch("https://hermitccp.github.io/ocforecast/surf.json");
          const surfData = await surfRes.json();

          for (const day of surfData.forecast) {
            const rating = calculateRating(day);

            const card = document.createElement("div");
            card.className = "day-card";
            card.innerHTML = `
              <h3>${day.day} ${day.date}</h3>
              <p><strong>Surf:</strong> ${day.surf} ft</p>
              <p><strong>Wind:</strong> ${day.wind}</p>
              <p><strong>Swell:</strong> ${day.swell}</p>
              <p><strong>Rating:</strong> <span class="rating">${rating}</span></p>
            `;

            card.addEventListener("click", () => showDetails(day, rating));
            forecastGrid.appendChild(card);
          }
        } catch (err) {
          forecastGrid.innerHTML = "<p>Error loading forecast. Try again later.</p>";
          console.error("Forecast error:", err);
        }
      }

      function calculateRating(day) {
        const surf = parseFloat(day.surf.split("â€“")[0]);
        const wind = day.wind.toLowerCase();
        const swell = day.swell.toLowerCase();

        if (surf < 1) return "Flat";
        if (surf < 2) return "Ok";
        if (surf < 4 && swell.includes("e") && wind.includes("off")) return "Good";
        if (surf >= 4 && swell.includes("e") && wind.includes("off")) return "Great";
        if (surf >= 5 && wind.includes("light") && swell.includes("clean")) return "Epic";
        return "Ok";
      }

      function showDetails(day, rating) {
        modalContent.innerHTML = `
          <h2>${day.day} ${day.date}</h2>
          <p><strong>Surf:</strong> ${day.surf}</p>
          <p><strong>Swell:</strong> ${day.swell}</p>
          <p><strong>Wind:</strong> ${day.wind}</p>
          <p><strong>Rating:</strong> <span class="rating">${rating}</span></p>
          <p><strong>Air Temp:</strong> ${day.air || 'N/A'}</p>
          <p><strong>Water Temp:</strong> ${day.water || 'N/A'}</p>
          <p><strong>Weather:</strong> ${day.weather || 'N/A'}</p>
          <p><strong>Sunrise:</strong> ${day.sunrise || 'N/A'}, <strong>Sunset:</strong> ${day.sunset || 'N/A'}</p>
        `;
        modal.style.display = "flex";
      }

      modal.addEventListener("click", () => {
        modal.style.display = "none";
      });

      loadForecast();
    </script>
  </body>
</html>
